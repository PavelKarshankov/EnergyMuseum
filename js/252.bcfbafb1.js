"use strict";(self["webpackChunkbelarusian_energy"]=self["webpackChunkbelarusian_energy"]||[]).push([[252],{4730:function(a,e,t){t.r(e),t.d(e,{default:function(){return B}});var r=t(9835),o=t(499),l=t(6970),d=t(9302),n=t(4587),s=t.n(n),i=t(4409),c=t(6173),u=t.n(c),g=t(9343),p=t(6611),_=(t(9217),t(3242)),m=t(4494),v=t(3125),b=t(4891),f=t(5096),y=t(5358);const T={class:"map"},w={class:"map__control map__control_draggable-cards"},k={class:"map__control_draggable-cards__row"},h=["data-station-id"],V=["data-station-id"];var U=(0,r.aZ)({__name:"FindTheStationPage",setup(a){const e=(0,d.Z)(),t=(0,p.k)();let n;const c=s().layerGroup(),U=(0,o.iH)(null),Z=(0,o.iH)(S()),A=(0,o.iH)(!1),L=(0,o.iH)(!0),C=(0,r.Fl)((()=>Z.value.every((a=>a.isDroppableSuccess))));function S(){const a=[],e=[];for(let r=0;r<4;r++){let o;do{o=(0,i.random)(g.yp.Brest,g.yp.Vitebsk)}while(e.includes(o));e.push(o);const l=(0,i.sample)((0,i.filter)(t.stations,["region",e[r]]));l.isDroppableSuccess=!1,a.push(l)}return a}function B(){c.clearLayers(),Z.value.forEach((a=>{var e;if(!a.coords)return;const t=s().marker(a.coords,{icon:(0,_.IU)((0,_.Vf)(a.type))}).addTo(n),r=s().popup({offset:s().point(0,80),closeButton:!1,autoClose:!1,closeOnEscapeKey:!1,closeOnClick:!1}).setLatLng(a.coords).addTo(n);c.addLayer(t),c.addLayer(r),c.addTo(n),null===(e=r.getElement())||void 0===e||e.setAttribute("data-station-id",a.id)}))}return(0,r.bv)((()=>{n=s().map(U.value,{zoomControl:!1,dragging:!!e.platform.is.mobile,minZoom:e.platform.is.mobile?6:7,maxZoom:7,maxBounds:s().latLngBounds(s().latLng(56.16645553553367,23.148533649131213),s().latLng(51.216634055031754,32.79452974288121))}).setView([53.61,28.042],e.platform.is.mobile?6:7),n.removeControl(n.attributionControl),s().tileLayer.provider("Jawg.Dark",{accessToken:"p8v9eYroy5BCXMxrTvvVfsRTBUIehEPiazUgb9U7WS3f8w8Tn7WFUvTVoKbBVx1z"}).addTo(n),B(),u()(".leaflet-popup").dropzone({accept:".map__control_draggable-cards__draggable-card",ondrop(a){if(!a.relatedTarget)return;const e=(0,i.find)(Z.value,["id",a.relatedTarget.getAttribute("data-station-id")]),t=(0,i.find)(Z.value,["id",a.currentTarget.getAttribute("data-station-id")]);e&&t&&e.id===t.id&&(t.isDroppableSuccess=!0),C.value&&(A.value=!0,setTimeout((()=>{A.value=!1,Z.value=S(),B(),document.querySelectorAll(".map__control_draggable-cards__draggable-card").forEach((a=>{a.style.transform="translate(0, 0)",a.removeAttribute("data-x"),a.removeAttribute("data-y")}))}),2500))},ondragleave(a){if(!a.relatedTarget)return;const e=(0,i.find)(Z.value,["id",a.relatedTarget.getAttribute("data-station-id")]),t=(0,i.find)(Z.value,["id",a.currentTarget.getAttribute("data-station-id")]);e&&t&&e.id===t.id&&(t.isDroppableSuccess=!1)}}),u()(".map__control_draggable-cards__draggable-card").draggable({listeners:{move:m.h}})})),(0,r.Ah)((()=>{t.isFirstVisit=!0})),(a,e)=>{const t=(0,r.up)("q-page");return(0,r.wg)(),(0,r.j4)(t,{class:"page_test"},{default:(0,r.w5)((()=>[(0,r._)("div",T,[(0,r._)("div",{ref_key:"mapElem",ref:U,class:"fit"},null,512),(0,r._)("div",w,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,o.SU)(i.chunk)(Z.value,2),(a=>((0,r.wg)(),(0,r.iD)("div",k,[(0,r._)("div",{class:"map__control_draggable-cards__draggable-card","data-station-id":a[0].id},(0,l.zw)(a[0].name),9,h),(0,r._)("div",{class:"map__control_draggable-cards__draggable-card","data-station-id":a[1].id},(0,l.zw)(a[1].name),9,V)])))),256))])]),(0,r.Wm)(v.Z,{modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=a=>A.value=a)},null,8,["modelValue"]),(0,r.Wm)(b.Z,{class:"map__control page__collapse",modelValue:L.value,"onUpdate:modelValue":e[1]||(e[1]=a=>L.value=a),caption:"Правила"},{default:(0,r.w5)((()=>[(0,r.Uk)(" Переместите название станции к соответствующей метке ")])),_:1},8,["modelValue"]),(0,r.Wm)(f.Z,{class:"map__control"}),(0,r.Wm)(y.Z,null,{default:(0,r.w5)((()=>[(0,r.Uk)("На главную")])),_:1})])),_:1})}}}),Z=t(1639),A=t(9885),L=t(9984),C=t.n(L);const S=(0,Z.Z)(U,[["__scopeId","data-v-4ac0eafb"]]);var B=S;C()(U,"components",{QPage:A.Z})}}]);